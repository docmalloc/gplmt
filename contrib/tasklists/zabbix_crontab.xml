<?xml version="1.0" encoding="UTF-8"?>
<tasklist name="Start zabbix agent on reboot (crontab)" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="../tasklist_schema.xsd">
	
	<run id="0" name="check peer">
		<!-- Check if peer is working -->
        <command>sudo date</command> 
        <arguments></arguments> 
        <timeout>10</timeout>
        <expected_return_code>0</expected_return_code>
        <expected_output>2013</expected_output>
        <stop_on_fail>true</stop_on_fail>
	</run>
	
	<sequence enabled="true">
	    <run id="0" name="Add tumple_gnunet to allow list">
            <command>echo tumple_gnunet | sudo tee -a /etc/cron.allow</command> 
            <arguments></arguments> 
            <timeout>0</timeout>
            <expected_return_code>0</expected_return_code>
            <expected_output></expected_output>
            <stop_on_fail>false</stop_on_fail>
	    </run>
	    
	    <run id="1" name="add reboot entry to crontab file">
            <command>echo "@reboot /usr/local/sbin/zabbix_agentd -c ~/zabbix_agentd.conf" | sudo tee -a /var/spool/cron/tumple_gnunet</command> 
            <arguments></arguments> 
            <timeout>0</timeout>
            <expected_return_code>0</expected_return_code>
            <expected_output></expected_output>
            <stop_on_fail>true</stop_on_fail>
	    </run>

	    <run id="2" name="start crontab service">
            <command>sudo /etc/init.d/crond start</command> 
            <arguments></arguments> 
            <timeout>0</timeout>
            <expected_return_code>0</expected_return_code>
            <expected_output></expected_output>
            <stop_on_fail>true</stop_on_fail>
	    </run>
    </sequence>
</tasklist>
